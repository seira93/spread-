# 🌐 Google Drive 画像ダウンローダー Web版 (Windows)

## 📋 概要

このアプリケーションは、Google Driveのフォルダから画像を自動でダウンロードし、Google スプレッドシートのIMAGE関数を生成するWebベースのGUIアプリケーションです。

## 🚀 インストールとセットアップ

### 1. 必要なファイル

以下のファイルが含まれていることを確認してください：
- `GoogleDriveDownloaderWeb.exe` - メインアプリケーション
- `client_secret.json` - Google API認証ファイル
- `start_application.bat` - Windows用起動スクリプト（オプション）

### 2. Google API認証の設定

1. `client_secret.json`ファイルが正しく配置されていることを確認
2. 初回実行時にGoogle認証が必要です
3. ブラウザでGoogleアカウントにログインして認証を完了

## 🎯 使用方法

### 方法1: 直接実行
1. `GoogleDriveDownloaderWeb.exe`をダブルクリック
2. ブラウザが自動で開きます
3. Web画面で設定を入力して実行

### 方法2: バッチファイル使用
1. `start_application.bat`をダブルクリック
2. コマンドプロンプトが開き、アプリケーションが起動
3. ブラウザで http://localhost:8080 にアクセス

### 方法3: コマンドライン
1. コマンドプロンプトを開く
2. アプリケーションフォルダに移動
3. `GoogleDriveDownloaderWeb.exe`を実行

## ⚙️ 設定項目

### 基本設定
- **スプレッドシートURL**: Google スプレッドシートのURL
- **シート名**: 使用するシート名（例: "第3弾"）
- **開始行**: 処理を開始する行番号（通常は2）
- **ダウンロード先**: 画像を保存するフォルダのパス

### モード選択
- **画像ダウンロードモード**: 画像をローカルにダウンロード
- **IMAGE関数生成モード**: スプレッドシートにIMAGE関数を生成

## 🔧 トラブルシューティング

### よくある問題

#### 1. アプリケーションが起動しない
- **原因**: ファイアウォールのブロック
- **解決**: Windows Defenderで「許可」を選択

#### 2. ブラウザが開かない
- **原因**: ポート8080が使用中
- **解決**: 手動で http://localhost:8080 にアクセス

#### 3. 認証エラー
- **原因**: `client_secret.json`の配置ミス
- **解決**: ファイルが正しい場所にあるか確認

#### 4. ダウンロード先エラー
- **原因**: パスの指定ミス
- **解決**: 例: `C:\Users\YourName\Downloads`

### エラーメッセージの対処

#### "ポート8080が使用中です"
- アプリケーションが自動的に別のポート（8081-8089）を試行
- ログで実際のポート番号を確認

#### "client_secret.jsonが見つかりません"
- ファイルがアプリケーションと同じフォルダにあるか確認
- ファイル名の大文字小文字を確認

#### "Google認証に失敗しました"
- インターネット接続を確認
- ファイアウォールの設定を確認
- 別のブラウザで試行

## 📁 ファイル構成

```
GoogleDriveDownloaderWeb_Package_Windows/
├── GoogleDriveDownloaderWeb.exe    # メインアプリケーション
├── client_secret.json              # Google API認証ファイル
├── start_application.bat           # Windows用起動スクリプト
├── README.md                       # 基本説明書
├── USAGE_GUIDE.md                  # 使用方法ガイド
├── QUICK_START_GUIDE.md           # クイックスタートガイド
└── config.json                     # 設定ファイル（自動生成）
```

## 🔒 セキュリティ

### ファイアウォール設定
- 初回実行時にWindows Defenderの警告が表示される場合があります
- 「詳細情報」→「実行」を選択して許可してください

### ネットワークアクセス
- アプリケーションはローカルホスト（localhost）でのみ動作
- 外部への通信はGoogle API認証時のみ

## 📞 サポート

### ログの確認方法
1. Web画面の「ログ表示」エリアを確認
2. エラーメッセージをコピーして保存
3. 問題の詳細を記録

### よくある質問

**Q: アプリケーションを停止するには？**
A: コマンドプロンプトウィンドウを閉じるか、Web画面の「🛑 停止」ボタンをクリック

**Q: 設定を保存するには？**
A: Web画面の「💾 設定保存」ボタンをクリック

**Q: 別のポートを使用したい場合は？**
A: アプリケーションが自動的に利用可能なポートを検索します

**Q: 複数のスプレッドシートを処理できますか？**
A: 一度に1つのスプレッドシートのみ処理可能です

## 🆕 更新履歴

### v1.0.0
- 初回リリース
- WebベースGUI
- 画像ダウンロード機能
- IMAGE関数生成機能
- Windows対応

## 📄 ライセンス

このアプリケーションは内部使用目的で開発されています。 